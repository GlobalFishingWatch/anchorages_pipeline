version: '2'
services:
  thin_port_messages:
    image: gfw/pipe-anchorages
    build:
      context: .
      dockerfile: Dockerfile-scheduler
    entrypoint: ["python", "-m", "pipe_anchorages.thin_port_messages"]
    volumes:
      - ".:/opt/project"
      - "gcp:/root/.config/"
  port_visits:
    image: gfw/pipe-anchorages
    build:
      context: .
      dockerfile: Dockerfile-scheduler
    entrypoint: ["python", "-m", "pipe_anchorages.port_visits"]
    volumes:
      - ".:/opt/project"
      - "gcp:/root/.config/"
  anchorages:
    image: gfw/pipe-anchorages
    build:
      context: .
      dockerfile: Dockerfile-scheduler
    entrypoint: ["python", "-m", "pipe_anchorages.anchorages"]
    volumes:
      - ".:/opt/project"
      - "gcp:/root/.config/"
  name_anchorages:
    image: gfw/pipe-anchorages
    build:
      context: .
      dockerfile: Dockerfile-scheduler
    entrypoint: ["python", "-m", "pipe_anchorages.name_anchorages"]
    volumes:
      - ".:/opt/project"
      - "gcp:/root/.config/"
  gcloud:
    image: gfw/pipe-anchorages
    build:
      context: .
      dockerfile: Dockerfile-scheduler
    entrypoint: gcloud
    volumes:
      - "gcp:/root/.config/"
  test:
    entrypoint: ["py.test",  "test"]
    image: gfw/pipe-anchorages
    build:
      context: .
      dockerfile: Dockerfile-scheduler
    volumes:
      - ".:/opt/project"
      - "gcp:/root/.config/"

volumes:
  gcp:
    external: True
